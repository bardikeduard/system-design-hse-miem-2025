## HW: сервисы и интеграции

### 1. Сервисы

1.  Сервис пользователей: управляет профилями пользователей и историей участия.
2.  Сервис аукционов: отвечает за создание, управление, категоризацию и модерацию аукционов и лотов. Предоставляет информацию для каталога.
3.  Сервис ставок: ядро системы. Обрабатывает прием, валидацию и фиксацию ставок в реальном времени. Определяет текущую лидирующую ставку.
4.  Сервис поиска: обеспечивает сложный поиск и фильтрацию аукционов по категориям, ключевым словам и другим параметрам.
5.  Платежный сервис: интегрируется с внешними платежными системами для обработки финансовых операций.
6.  Сервис видеостриминга: управляет захватом видеопотока с оффлайн-площадки и его раздачей онлайн-участникам с минимальной задержкой.
7.  Сервис уведомлений: отправляет пользователям уведомления в реальном времени через различные каналы (websockets, email, пуши в приложение).
8.  API gateway: единая точка входа для всех клиентских приложений (веб, приложения). Маршрутизирует запросы к соответствующим сервисам.

### 2. Интеграции и их обоснование

| Откуда | Куда | Способ взаимодействия | Обоснование |
| :--- | :--- | :--- | :--- |
| Клиент (браузер/приложение) | API gateway | Синхронный (HTTPS/REST) | Стандартный способ для взаимодействия с клиентами. |
| Клиент (браузер/приложение) | Сервис ставок | Real-time (websockets) | Для отправки ставок на сервер и получения обновлений о текущей цене без задержек в реальном времени. |
| Клиент (браузер/приложение) | Сервис уведомлений | Real-time (websockets) | Для доставки уведомлений о ходе аукциона  в реальном времени. |
| API gateway | Все внутренние сервисы | Синхронный (gRPC) | Для внутренних коммуникаций gRPC предпочтительнее REST из-за большей производительности и низкой задержки, что важно для системы с высокой нагрузкой. |
| Сервис ставок | Сервис уведомлений | Асинхронный | После принятия ставки, сервис ставок отправляет событие в очередь. Сервис уведомлений обрабатывает его, не блокируя и не замедляя критически важный сервис ставок. |
| Сервис ставок | Сервис пользователей | Синхронный (gRPC) | Перед принятием ставки нужно быстро проверить, достаточно ли у пользователя средств. Это блокирующая операция. |
| Сервис аукционов | Сервис поиска | Асинхронный | При создании или обновлении аукциона данные отправляются в очередь, откуда сервис поиска забирает их для индексации. Это не замедляет основной сервис и повышает надежность. |
| Сервис аукционов | Платежный сервис / сервис уведомлений | Асинхронный | По завершении аукциона сервис аукционов публикует событие. Платежный сервис инициирует списание, а сервис уведомлений оповещает победителя. Связь с платёжным сервисом может быть асинхронной, т.к. сервис аукционов фиксирует на момент завершения последнюю ставку, т.е. мы точно знаем какой клиент сколько должен заплатить. Можно в целом сделать и синхронной, но тогда возможен затык при завершении аукциона в случае, если платёжный сервис упал. |
